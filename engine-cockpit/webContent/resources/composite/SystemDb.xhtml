<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui">
<cc:implementation>
  <h:form id="systemDbForm">
    <div class="ui-g">
      <div class="ui-g-12">
        <p:outputPanel id="connectionPanel" styleClass="connection-panel">
          <div class="ui-message ui-staticmessage #{systemDatabaseBean.connectionInfo.stateCssValue} ui-widget ui-corner-all">
            <i class="#{systemDatabaseBean.connectionInfo.connectionIcon}" />
            <span class="ui-message-error-summary">#{systemDatabaseBean.connectionInfo.stateTitle}</span>
            <span class="ui-message-error-detail">#{systemDatabaseBean.connectionInfo.stateMessage}</span>
          </div>
          
          <div>
            <p:commandButton value="Check Connection" id="checkConnectionButton" styleClass="wizard-top-button secondary-btn"
              icon="ui-icon-check" update="@(.configChanged)" actionListener="#{systemDatabaseBean.testConnection()}" />
            <p:commandButton value="Create Database" id="createDatabaseButton" icon="ui-icon-dns" styleClass="wizard-top-button secondary-btn" 
              update="@(.configChanged)" actionListener="#{systemDatabaseBean.testConnection()}" disabled="true" />
            <p:commandButton value="Migrate Database" id="migrateDatabaseButton" icon="ui-icon-autorenew" styleClass="wizard-top-button secondary-btn"
              update="@(.configChanged)" actionListener="#{systemDatabaseBean.testConnection()}" disabled="true" />
          </div>
        </p:outputPanel>
      </div>
  
      <div class="ui-g-12 ui-md-12 ui-lg-9">
        <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-3, ui-grid-col-9" 
          styleClass="ui-panelgrid-blank form-group modal-input-form grey-label-panel ui-fluid">
          <p:outputLabel for="databaseType" value="Database" />
          <p:selectOneMenu id="databaseType" value="#{systemDatabaseBean.product}">
            <f:selectItems value="#{systemDatabaseBean.supporedDatabaseNames}" var="database" itemLabel="#{database}" itemValue="#{database}" />
            <p:ajax update="@form" process="@this" />
          </p:selectOneMenu>
    
          <p:outputLabel for="databaseDriver" value="Driver" />
          <p:selectOneMenu id="databaseDriver" value="#{systemDatabaseBean.driver}">
            <f:selectItems value="#{systemDatabaseBean.supportedDriverNames}" var="driver" itemLabel="#{driver}" itemValue="#{driver}" />
            <p:ajax update="@form" process="@this" />
          </p:selectOneMenu>
          
          <p:outputLabel for="host" value="Host" />
          <p:inputText id="host" value="#{systemDatabaseBean.host}">
            <p:ajax event="keydown" update="@(.configChanged)" />
          </p:inputText>
          
          <p:outputLabel for="port" value="Port" />
          <h:panelGroup>
            <p:inputText id="port" value="#{systemDatabaseBean.port}" disabled="#{systemDatabaseBean.defaultPort}" style="width: calc(100% - 105px);">
              <p:ajax event="keydown" update="@(.configChanged)" />
            </p:inputText>
            <p:selectBooleanCheckbox id="defaultPortCheckbox" style="margin: 0; float: right;"
              itemLabel="Default" value="#{systemDatabaseBean.defaultPort}" >
              <p:ajax process="@this" update="@form" />
            </p:selectBooleanCheckbox>
          </h:panelGroup>
          
          <p:outputLabel for="databaseName" id="databaseNameLabel" value="#{systemDatabaseBean.product eq 'Oracle' ? 'Oracle Service ID' : 'Database Name'}" />
          <p:inputText id="databaseName" value="#{systemDatabaseBean.dbName}">
            <p:ajax event="keydown" update="@(.configChanged)" />
          </p:inputText>
          
          <p:outputLabel for="username" value="Username" />
          <p:inputText id="username" value="#{systemDatabaseBean.userName}" autocomplete="off">
            <p:ajax event="keydown" update="@(.configChanged)" />
          </p:inputText>
          
          <p:outputLabel for="password" value="Password" />
          <p:password id="password" value="#{systemDatabaseBean.password}" redisplay="true" autocomplete="new-password">
            <p:ajax event="keydown" update="@(.configChanged)" />
          </p:password>
        </p:panelGrid>
      </div>
    </div>
  </h:form>
</cc:implementation>
</html>
