<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui">
<cc:interface>
  <cc:attribute name="log" shortDescription="Log File" />
</cc:interface>
<cc:implementation>
  <p:panel id="logPanel" widgetVar="#{cc.attrs.log.fileName}">
    <f:facet name="header">
      <span onclick="PF('#{cc.attrs.log.fileName}').toggle()" style="cursor: pointer;" class="p-d-inline-flex">
        <i class="si si-common-file-text table-icon panel-title-icon"></i>
        <h:outputText value="#{cc.attrs.log.fileName} (#{cc.attrs.log.size})" styleClass="p-ml-1" />
      </span>
    </f:facet>
    <f:facet name="actions">
      <h:form id="fileForm">
        <p:commandLink id="showLog" ajax="false" title="Open log" 
          styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default">
          <i class="si si-expand-6"></i>
          <p:fileDownload contentDisposition="inline" value="#{cc.attrs.log.file}" />
        </p:commandLink>
        <p:commandLink id="downloadLog" ajax="false" title="Download log" 
          styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default">
          <i class="si si-download-bottom"></i>
          <p:fileDownload value="#{cc.attrs.log.file}" />
        </p:commandLink>
      </h:form>
    </f:facet>
    <pre id="scrollLog" style="max-height: calc(100vh - 300px); overflow-x: auto; margin: 0;"><h:outputText value="#{cc.attrs.log.content}"/></pre>
    <script type="text/javascript">
      // scroll at the end by default
      let objDiv = document.getElementById("scrollLog");
      objDiv.scrollTop = objDiv.scrollHeight;
    </script>
  </p:panel>
</cc:implementation>

</html>
