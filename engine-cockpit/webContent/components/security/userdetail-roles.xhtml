<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:pm="http://primefaces.org/mobile">

<h:form id="rolesOfUserForm">
  <p:growl for="roleMessage" autoUpdate="true" />
  <div class="ui-datatable-header ui-widget-header ui-corner-top" style="border-bottom: 0 none;">
    <div class="ui-outputpanel ui-widget">
      <label style="float: left;" class="ui-outputlabel ui-widget table-search-icon"> <i class="material-icons">search</i>
      </label>
      <p:inputText style="width: calc(100% - 24px); color: #ffffff;" placeholder="Search" value="#{roleBean.filter}">
        <p:ajax event="keyup" delay="300" update="@form" />
      </p:inputText>
    </div>
  </div>
  <p:treeTable id="rolesTree" value="#{roleBean.roles}" var="role">
    <p:column headerText="All Roles" sortBy="#{role.name}">
      <a href="roledetail.xhtml?roleName=#{role.name}">
        <h:outputText value="#{role.name}" styleClass="role-name">
          <i class="material-icons table-icon">group</i>
        </h:outputText>
        <h:outputText value=" (#{role.displayName})" styleClass="addition-row-info" />
      </a>
    </p:column>
    <p:column style="width: 20px;">
      <h:outputText
        rendered="#{userDetailBean.isUserMemberOfAllRole(role.name) and !userDetailBean.isUserMemberOfRole(role.name)}">
        <i class="fa fa-check table-icon member-inherit-icon no-margin" title="Inherited" />
      </h:outputText>
      <h:outputText
        rendered="#{userDetailBean.isUserMemberOfAllRole(role.name) and userDetailBean.isUserMemberOfRole(role.name)}">
        <i class="fa fa-check table-icon no-margin" />
      </h:outputText>
    </p:column>
    <p:column style="width: 70px;">
      <p:commandButton id="addRoleToUserBtn" update="@form" actionListener="#{userDetailBean.addRole(role.name)}"
        icon="ui-icon-add" title="Add" styleClass="card-button table-control-btn primary-btn" style="margin: 0;"
        disabled="#{role.name == 'Everybody' or userDetailBean.isUserMemberOfRole(role.name) or (!managerBean.ivySecuritySystem and role.adSynced)}" />
      <p:commandButton id="removeRoleFromUserBtn" update="@form"
        actionListener="#{userDetailBean.removeRole(role.name)}" icon="ui-icon-remove" title="Remove"
        styleClass="card-button table-control-btn secondary-btn"
        disabled="#{role.name == 'Everybody' or !userDetailBean.isUserMemberOfRole(role.name) or (!managerBean.ivySecuritySystem and role.adSynced)}" />
    </p:column>
  </p:treeTable>
</h:form>
</html>