<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions" xmlns:pm="http://primefaces.org/mobile"
  xmlns:cc="http://java.sun.com/jsf/composite/composite">
<h:body>
  <f:metadata>
    <f:viewParam name="log" value="#{logBean.showLog}" />
  </f:metadata>

  <ui:composition template="/template/template.xhtml">
    
    <ui:define name="breadcrumb">
      <li><a href="editor.xhtml">Editor</a></li>
    </ui:define>
    
    <ui:define name="content">
      <cc:SingleCard id="card">
        <p:tabView id="editorTabView" styleClass="card tab-view-card" value="#{editorBean.configFiles}" var="config"
          onTabShow="editor_#{config.varName}.refresh()" style="margin-bottom: 0;">
          <p:tab title="#{config.fileName}" titleStyleClass="application-tab">
            <div class="ui-g">
              <div class="ui-g-12">
                <textarea id="yamlhints_#{config.varName}" style="display: none"><h:outputText value="#{config.keys}"/></textarea>
                <textarea id="editor_#{config.varName}" style="display: none"><h:outputText value="#{config.content}"/></textarea>
                
                <script>
                  console.log("#{config.varName}");
                  yamlHintDirectory = $('#yamlhints_#{config.varName}').text().split(',');
                  
                  var editor_#{config.varName} = CodeMirror.fromTextArea(document.getElementById("editor_#{config.varName}"), {
                    lineNumbers: true,
                    mode: "text/x-yaml",
                    tabSize: 2,
                    extraKeys: {"Ctrl-Space": "autocomplete",
                      Tab: function(cm) {
                        var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
                        cm.replaceSelection(spaces);
                      }
                    }
                  });
                </script>
                <h:form>
                  <p:commandButton id="saveEdit" type="button" style="width: 150px; float: right; margin-left: 10px;"
                    value="Save" icon="ui-icon-save" styleClass="primary-btn" />
                  <p:commandButton id="cancelEdit" onclick="editor_${config.varName}.undo()" value="Cancel" type="button"
                    icon="ui-icon-clear" styleClass="secondary-btn" style="width: 150px; float: right;"/>
                </h:form>
              </div>
            </div>
          </p:tab>
        </p:tabView>
        <script>
          $('.ui-tabs-panels .cm-s-default').height(window.innerHeight - 260)
        </script>
      </cc:SingleCard>
    </ui:define>
  </ui:composition>
</h:body>
</html>