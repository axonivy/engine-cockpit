<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions" xmlns:cc="http://java.sun.com/jsf/composite/composite">
<h:body>
  <ui:composition template="../includes/template/template.xhtml">

    <ui:define name="breadcrumb">
      <li><span>Security</span></li>
      <li>/</li>
      <li><a href="securitysystem.xhtml">Merge Security Systems</a></li>
    </ui:define>

    <ui:define name="topbar-items">
      <cc:TopBarItem href="#{advisorBean.cockpitEngineGuideUrl}security.html#security-system" />
    </ui:define>

    <ui:define name="content">
      <div class="card">
        <h:form id="form">
          <p:growl for="msgs" id="msgs" showDetail="true">
            <p:autoUpdate />
          </p:growl>
          <div class="p-d-flex p-ai-center p-mb-3">
            <i class="p-pr-3 si si-lock-1 card-title-icon"></i>
            <h2 class="p-m-0">Merge Security Systems</h2>
          </div>
  
		  <p:panelGrid columns="1" layout="flex" styleClass="compare-card">
			  <p:outputLabel style="font-weight:bold;" for="sourceSecuritySystem">Source Security System</p:outputLabel>
			  <p:selectOneMenu id="sourceSecuritySystem" value="#{securitySystemCompareBean.sourceSecuritySystem}" >
			  	<f:selectItems value="#{securitySystemCompareBean.securitySystems}" var="securitySystem" itemLabel="#{securitySystem}" itemValue="#{securitySystem}"/>
			  </p:selectOneMenu>
			  
			  <p:outputLabel style="font-weight:bold;" for="sourceSecuritySystem">Target Security System</p:outputLabel>
			  <p:selectOneMenu id="targetSecuritySystem" value="#{securitySystemCompareBean.targetSecuritySystem}" >
			  	<f:selectItems value="#{securitySystemCompareBean.securitySystems}" var="securitySystem" itemLabel="#{securitySystem}" itemValue="#{securitySystem}"/>
			  </p:selectOneMenu>

		  	<p:commandButton update="form" value="Compare" ajax="false" title="This will only compare source with target security system. This will NOT make any changes." actionListener="#{securitySystemCompareBean.run}" />
		  </p:panelGrid>

		  <p:panelGrid rendered="#{securitySystemCompareBean.isReportAvailable()}" columns="1" layout="flex" styleClass="compare-card">
		  <br />
			   <h3 class="p-m-0">Comparison Report</h3>
			  
			   <p:dataTable id="report" var="issue" value="#{securitySystemCompareBean.report}">
	            <p:column style="width:50px;">
	                <h:outputText value="#{issue.entity()}" />
	            </p:column>
	            
	            <p:column headerText="Name" style="width:120px;">
	                <h:outputText value="#{issue.id()}" />
	            </p:column>
	            
	            <p:column headerText="What">
	                <h:outputText value="#{issue.what()} #{issue.name()}" />
	            </p:column>
	
	            <p:column headerText="Source">
	                <h:outputText value="#{issue.source()}" />
	            </p:column>
	
	            <p:column headerText="Target">
	                <h:outputText value="#{issue.target()}" />
	            </p:column>
	            
	            <p:column >
	                <p:commandButton value="#{issue.solver().type()}" title="#{securitySystemCompareBean.solveHint(issue)}" rendered="#{issue.isSolveable()}" enabled="${securitySystemCompareBean.isSolved(issue)}" update="report" actionListener="#{securitySystemCompareBean.solve(issue)}" oncomplete="solveButton(this)" />                
	            </p:column>
	           </p:dataTable>
	           
	           <script>
			     function solveButton(button) {
				   button.value = 'solved';
				 }
				</script>
			</p:panelGrid>
        </h:form>
      </div>
    </ui:define>
  </ui:composition>
</h:body>
</html>
