<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:cc="http://java.sun.com/jsf/composite/composite">
<h:body>
  <f:metadata>
    <f:viewParam name="appName" value="#{pmvDetailBean.appName}" />
    <f:viewParam name="appName" value="#{managerBean.selectedApplicationName}" />
    <f:viewParam name="pmName" value="#{pmvDetailBean.pmName}" />
    <f:viewParam name="pmvVersion" value="#{pmvDetailBean.pmvVersion}" />
  </f:metadata>
  
  <ui:composition template="../includes/template/template.xhtml">
    
    <ui:define name="breadcrumb">
      <li><a href="applications.xhtml">Applications</a></li>
      <li>/</li>
      <li><a href="application-detail.xhtml?appName=#{pmvDetailBean.appName}">#{pmvDetailBean.appName}</a></li>
      <li>/</li>
      <li><a href="#{pmvDetailBean.pmv.detailView}">#{pmvDetailBean.pmv.name}</a></li>
    </ui:define>
    
    <ui:define name="breadcrumb-right">
      <a href="#{advisorBean.cockpitEngineGuideUrl}applications.html#pmv-detail" target="_blank" rel="noopener noreferrer">
        <i class="material-icons">help</i>
      </a>
    </ui:define>
    
    <ui:define name="content">
      <div class="ui-g ui-fluid dashboard">
        <div class="ui-g-12 ui-md-12 ui-lg-8 dashboard-card">
          <p:panel id="info" styleClass="min-height-200">
            <f:facet name="header">
              <i class="material-icons table-icon panel-title-icon">info</i>
              <h:outputText value="PMV information" />
            </f:facet>
            <p:panelGrid columns="2" columnClasses="ui-grid-col-4, ui-grid-col-8" layout="grid" styleClass="ui-panelgrid-blank grey-label-panel">
              <label>Name</label>
              <h:outputText value="#{pmvDetailBean.pmv.name}" />
              <label>Version</label>
              <h:outputText value="#{pmvDetailBean.pmvVersion}" />
              <label>Deployed</label>
              <h:outputText value="#{pmvDetailBean.deployedProject}" />
              <label>Last changed</label>
              <h:outputText value="#{pmvDetailBean.pmv.lastChangeDate}" />
            </p:panelGrid>
          </p:panel>
        </div>
        
        <div class="ui-g-12 ui-md-12 ui-lg-4 dashboard-card">
          <p:panel id="activity" styleClass="min-height-200">
            <f:facet name="header">
              <i class="material-icons table-icon panel-title-icon">play_circle_outline</i>
              <h:outputText value="Activity" />
            </f:facet>
            <p:panelGrid columns="2" columnClasses="ui-grid-col-4, ui-grid-col-8" layout="grid" styleClass="ui-panelgrid-blank grey-label-panel">
              <label>State</label>
              <h:outputText id="operationStateLabel" value="#{pmvDetailBean.pmv.operationState}"
                styleClass="activity-state-#{pmvDetailBean.pmv.operationStateLowerCase}" />
              <label>Configured state</label>
              <h:outputText value="#{pmvDetailBean.pmv.state}"
                styleClass="activity-state-#{pmvDetailBean.pmv.stateLowerCase}" />
            </p:panelGrid>
          </p:panel>
        </div>
        
        <div class="ui-g-12 ui-md-12 ui-lg-12 dashboard-card">
          <p:panel styleClass="min-height-250">
            <f:facet name="header">
              <i class="material-icons table-icon panel-title-icon">device_hub</i>
              <h:outputText value="Specified required projects" />
            </f:facet>
            <p:dataTable id="specifiedTable" var="spec" value="#{pmvDetailBean.requiredSpecifications}"
              emptyMessage="The PMV '#{pmvDetailBean.pmv.name}' has no specified required projects.">
              <p:column headerText="Id">
                <h:outputText value="#{spec.Id}" title="#{spec.Id}" />
              </p:column>
              <p:column headerText="Version">
                <h:outputText value="#{spec.version}" />
              </p:column>
              <p:column headerText="Resolved PMV">
                <i class="material-icons state-#{spec.resolved ? 'active' : 'inactive'} table-icon" style="font-size: 24px; top: 5px;"
                  title="#{spec.resolvedTooltip}">#{spec.resolved ? 'done' : 'clear'}</i>
                <h:outputLink value="#{spec.resolvedPmv.detailView}">
                  <h:outputText value="#{spec.resolvedPmvName}" />
                </h:outputLink>
              </p:column>
            </p:dataTable>
          </p:panel>
        </div>
        
        <div class="ui-g-12 ui-md-12 ui-lg-12 dashboard-card">
          <p:panel styleClass="min-height-250">
            <f:facet name="header">
              <i class="material-icons table-icon panel-title-icon">arrow_upward</i>
              <h:outputText value="All PMVs depending on this PMV" />
            </f:facet>
            <p:dataTable id="dependentPmvTable" var="pmv" value="#{pmvDetailBean.dependentPmvs}" 
              emptyMessage="The PMV '#{pmvDetailBean.pmv.name}' has no dependend PMVs.">
              <p:column headerText="PMV">
                <h:outputLink value="#{pmv.detailView}">
                  <h:outputText value="#{pmv.name}" title="#{pmv.libraryId}">
                    <i class="fa fa-#{pmv.icon}" style="margin-right: 5px;" />
                  </h:outputText>
                </h:outputLink>
              </p:column>
              <p:column headerText="Resolved">
                <i class="material-icons state-#{pmv.libraryResolved ? 'active' : 'inactive'}"
                  title="#{pmv.libraryResolvedTooltip}">#{pmv.libraryResolved ? 'done' : 'clear'}</i>
              </p:column>
              <p:column headerText="Version">
                <h:outputText value="#{pmv.qualifiedVersion}" />
              </p:column>
              <p:column headerText="Activity state">
                <h:outputText styleClass="activity-state-#{pmv.operationStateLowerCase}"
                  value="#{pmv.operationState}" />
              </p:column>
              <p:column headerText="Release state">
                <h:outputText styleClass="release-state-#{pmv.releaseStateLowerCase}"
                  value="#{pmv.releaseState}" />
              </p:column>
            </p:dataTable>
          </p:panel>
        </div>
        
        <div class="ui-g-12 ui-md-12 ui-lg-12 dashboard-card">
          <p:panel styleClass="min-height-250">
            <f:facet name="header">
              <i class="material-icons table-icon panel-title-icon">arrow_downward</i>
              <h:outputText value="All PMVs required by this PMV" />
            </f:facet>
            <p:dataTable id="requriedPmvTable" var="pmv" value="#{pmvDetailBean.requiredPmvs}"
              emptyMessage="The PMV '#{pmvDetailBean.pmv.name}' has no required PMVs. 
                #{not empty pmvDetailBean.requiredSpecifications ? 'Although some required projects are specified!' : ''}">
              <p:column headerText="PMV">
                <h:outputLink value="#{pmv.detailView}">
                  <h:outputText value="#{pmv.name}" title="#{pmv.libraryId}">
                    <i class="fa fa-#{pmv.icon}" style="margin-right: 5px;" />
                  </h:outputText>
                </h:outputLink>
              </p:column>
              <p:column headerText="Resolved">
                <i class="material-icons state-#{pmv.libraryResolved ? 'active' : 'inactive'}"
                  title="#{pmv.libraryResolvedTooltip}">#{pmv.libraryResolved ? 'done' : 'clear'}</i>
              </p:column>
              <p:column headerText="Version">
                <h:outputText value="#{pmv.qualifiedVersion}" />
              </p:column>
              <p:column headerText="Activity state">
                <h:outputText styleClass="activity-state-#{pmv.operationStateLowerCase}"
                  value="#{pmv.operationState}" />
              </p:column>
              <p:column headerText="Release state">
                <h:outputText styleClass="release-state-#{pmv.releaseStateLowerCase}"
                  value="#{pmv.releaseState}" />
              </p:column>
            </p:dataTable>
          </p:panel>
        </div>
      </div>
    </ui:define>
  </ui:composition>
</h:body>
</html>